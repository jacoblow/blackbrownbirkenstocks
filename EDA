import googlemaps
import folium
import pandas as pd
import numpy as np
from datetime import datetime



file_path = "~/Desktop/shortenedSFcrimedata2.csv"
df = pd.read_csv(file_path)
weights = {
    "Arson": 40,
    "Assault": 90,
    "Disorderly Conduct": 10,
    "Drug Offense": 65,
    "Drug Violation": 65,
    "Homicide": 100,
    "Human Trafficking, Commercial Sex Acts": 70,
    "Larceny Theft": 40,
    "Liquor Laws": 25,
    "Motor Vehicle Theft": 50,
    "Prostitution": 60,
    "Rape": 92,
    "Robbery": 90,
    "Sex Offense": 75,
    "Suspicious": 8,
    "Suspicious Occ": 8,
    "Traffic Collision": 20,
    "Traffic Violation Arrest": 30,
    "Weapons Carrying Etc": 90,
    "Weapons Offense": 90
}

df["Incident_Weight"] = df["Incident Category"].map(weights)

df["Incident Datetime"] = pd.to_datetime(df["Incident Datetime"], errors='coerce')


current_date = datetime.now()
gamma = 0.01
emvec = []

df["Exponential_Score"] = df["Incident_Weight"] * np.exp((-1) * gamma * (current_date - df["Incident Datetime"]).dt.days)

print(df["Exponential_Score"])

output_file_path = "~/Desktop/shortenedSFcrimedata2_modified.csv"
df.to_csv(output_file_path, index=False)
